<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å€‹äººä¸­å¿ƒ - LunaPlay æœˆä¹‹ç›’</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .dashboard-page {
            min-height: 100vh;
            background: var(--bg-color);
        }
        
        .dashboard-header {
            background: url('assets/banner.jpg') center center / cover no-repeat;
            color: var(--white);
            padding: 2rem 0;
            position: relative;
        }
        
        .dashboard-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            z-index: 1;
        }
        
        .dashboard-header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        
        .home-icon {
            position: absolute;
            top: 1rem;
            left: 1rem;
            font-size: 2rem;
            cursor: pointer;
            z-index: 3;
            transition: transform 0.3s;
            text-decoration: none;
            color: var(--white);
        }
        
        .home-icon:hover {
            transform: scale(1.1);
        }
        
        .user-info h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .user-info p {
            opacity: 0.9;
        }
        
        .logout-button {
            background: rgba(255, 255, 255, 0.2);
            color: var(--white);
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s;
        }
        
        .logout-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .dashboard-nav {
            background: var(--white);
            border-bottom: 2px solid #E5E7EB;
            padding: 1rem 0;
        }
        
        .dashboard-nav .container {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        .nav-tab:hover {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            border-bottom: 3px solid;
            border-image: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) 1;
        }
        
        .tab-content {
            display: none;
            padding: 2rem 0;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .content-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: var(--shadow);
            margin-bottom: 1.5rem;
        }
        
        /* Force gradient on all content-card h3 titles */
        .content-card h3,
        div.content-card h3,
        .tab-content .content-card h3,
        .tab-content.active .content-card h3,
        #orders .content-card h3,
        #subscription .content-card h3,
        #addons .content-card h3,
        #orders h3,
        #subscription h3,
        #addons h3 {
            font-size: 1.5rem !important;
            margin-bottom: 1.5rem !important;
            background: linear-gradient(135deg, #6B46C1 0%, #DC2626 100%) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
            color: transparent !important;
        }
        
        /* Additional specific selectors for all h3 in tab-content */
        .tab-content h3,
        .tab-content.active h3 {
            background: linear-gradient(135deg, #6B46C1 0%, #DC2626 100%) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
            color: transparent !important;
        }
        
        /* Ensure pricing features alignment */
        .pricing-features {
            list-style: none;
            text-align: left;
            margin-bottom: 2rem;
            min-height: 280px;
        }
        
        .pricing-features li {
            padding: 0.75rem 0;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            border-bottom: 1px solid #E5E7EB;
        }
        
        .pricing-features li:last-child {
            border-bottom: none;
        }
        
        .pricing-features .feature-icon {
            min-width: 20px;
            width: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            flex-shrink: 0;
            margin: 0;
            padding: 0;
        }
        
        .pricing-features .feature-icon:not(.cross) {
            color: #10B981;
        }
        
        .pricing-features .feature-icon.cross {
            color: #EF4444;
        }
        
        .pricing-features .feature-text {
            flex: 1;
            display: flex;
            align-items: center;
            line-height: 1.5;
        }
        
        .order-item {
            background: #F9FAFB;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid;
            border-image: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) 1;
        }
        
        .order-item:nth-child(even) {
            border-left: 4px solid;
            border-image: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) 1;
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .order-title {
            font-weight: 600;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .order-date {
            color: var(--text-light);
            font-size: 0.875rem;
        }
        
        .order-details {
            color: var(--text-light);
            margin-top: 0.5rem;
        }
        
        .subscription-card {
            background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%);
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .subscription-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .status-badge {
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-weight: 600;
            font-size: 0.875rem;
        }
        
        .status-active {
            background: #D1FAE5;
            color: #065F46;
        }
        
        .status-inactive {
            background: #FEE2E2;
            color: #991B1B;
        }
        
        .subscription-info {
            margin: 1rem 0;
        }
        
        .subscription-info p {
            margin: 0.5rem 0;
            color: var(--text-color);
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .category-container {
            margin-bottom: 1rem;
        }
        
        .category-header {
            background: #F9FAFB;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            border: 2px solid #E5E7EB;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }
        
        .category-header:hover {
            background: linear-gradient(var(--white), var(--white)) padding-box,
                        linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) border-box;
            border: 2px solid transparent;
        }
        
        .category-header.active {
            background: linear-gradient(var(--white), var(--white)) padding-box,
                        linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) border-box;
            border: 2px solid transparent;
        }
        
        .category-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--text-color);
        }
        
        .category-icon {
            font-size: 1.5rem;
        }
        
        .category-arrow {
            font-size: 1.2rem;
            transition: transform 0.3s;
            color: var(--text-light);
        }
        
        .category-header.active .category-arrow {
            transform: rotate(180deg);
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .category-products {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
            padding: 0 0.5rem;
        }
        
        .category-products.expanded {
            display: grid;
            animation: slideDown 0.3s;
        }
        
        .product-card {
            background: var(--white);
            padding: 1.5rem;
            border-radius: 0.5rem;
            border: 2px solid #E5E7EB;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .product-card:hover {
            background: linear-gradient(var(--white), var(--white)) padding-box,
                        linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) border-box;
            border: 2px solid transparent;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .product-image {
            width: 100%;
            height: 120px;
            background: linear-gradient(135deg, #F3F4F6 0%, #E5E7EB 100%);
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: var(--text-light);
            overflow: hidden;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0.5rem;
        }
        
        .product-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-color);
            font-size: 0.95rem;
        }
        
        .product-price {
            color: var(--text-light);
            font-size: 0.875rem;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Product Detail Modal */
        .product-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }
        
        .product-modal-content {
            background-color: var(--white);
            margin: 2% auto;
            padding: 0;
            border-radius: 1rem;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideDown 0.3s;
            display: flex;
            flex-direction: column;
        }
        
        .product-modal-header {
            padding: 2rem;
            border-bottom: 1px solid #E5E7EB;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .product-modal-body {
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .product-image-container {
            background: #F9FAFB;
            border-radius: 0.5rem;
            padding: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            overflow: hidden;
        }
        
        .product-image-container img {
            width: 100%;
            height: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 0.5rem;
        }
        
        .product-image-container .product-image {
            font-size: 8rem;
            color: var(--text-light);
        }
        
        .product-info {
            display: flex;
            flex-direction: column;
        }
        
        .product-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-color);
        }
        
        .product-price {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
        }
        
        .product-specs {
            margin: 1.5rem 0;
        }
        
        .spec-item {
            padding: 0.75rem 0;
            border-bottom: 1px solid #E5E7EB;
            display: flex;
            justify-content: space-between;
        }
        
        .spec-label {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .spec-value {
            color: var(--text-light);
        }
        
        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .quantity-button {
            width: 40px;
            height: 40px;
            border: 2px solid #E5E7EB;
            background: var(--white);
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color);
            transition: all 0.2s;
        }
        
        .quantity-button:hover {
            background: linear-gradient(var(--white), var(--white)) padding-box,
                        linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%) border-box;
            border: 2px solid transparent;
        }
        
        .quantity-input {
            width: 80px;
            text-align: center;
            padding: 0.5rem;
            border: 2px solid #E5E7EB;
            border-radius: 0.5rem;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .total-price {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-color);
            margin: 1.5rem 0;
            padding-top: 1.5rem;
            border-top: 2px solid #E5E7EB;
        }
        
        .total-price span {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .cart-summary {
            background: #F9FAFB;
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-top: 2rem;
        }
        
        /* Community Embedded Styles */
        .community-page-embedded {
            display: flex;
            height: calc(100vh - 300px);
            max-height: 600px;
            background: #36393F;
            color: #DCDDDE;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .community-sidebar {
            width: 240px;
            background: #2F3136;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            flex-shrink: 0;
        }
        
        .community-server-header {
            height: 48px;
            background: #202225;
            display: flex;
            align-items: center;
            padding: 0 16px;
            border-bottom: 1px solid #202225;
            box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2);
        }
        
        .community-server-name {
            font-weight: 600;
            font-size: 16px;
            color: #FFFFFF;
        }
        
        .community-channels-container {
            flex: 1;
            padding: 16px 8px;
            overflow-y: auto;
        }
        
        .community-channel-category {
            margin-bottom: 24px;
        }
        
        .community-category-header {
            text-transform: uppercase;
            font-size: 12px;
            font-weight: 600;
            color: #8E9297;
            padding: 0 8px;
            margin-bottom: 8px;
            letter-spacing: 0.02em;
        }
        
        .community-channel-item {
            display: flex;
            align-items: center;
            padding: 6px 8px;
            margin: 2px 0;
            border-radius: 4px;
            cursor: pointer;
            color: #8E9297;
            transition: background 0.15s, color 0.15s;
        }
        
        .community-channel-item:hover {
            background: #393C43;
            color: #DCDDDE;
        }
        
        .community-channel-item.active {
            background: #393C43;
            color: #FFFFFF;
        }
        
        .community-channel-icon {
            margin-right: 6px;
            font-size: 16px;
        }
        
        .community-channel-name {
            font-size: 16px;
            font-weight: 500;
        }
        
        .community-main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #36393F;
        }
        
        .community-channel-header {
            height: 48px;
            background: #36393F;
            border-bottom: 1px solid rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            padding: 0 16px;
            box-shadow: 0 1px 0 rgba(4, 4, 5, 0.2);
            flex-shrink: 0;
        }
        
        .community-channel-header-icon {
            margin-right: 8px;
            font-size: 20px;
        }
        
        .community-channel-header-name {
            font-weight: 600;
            font-size: 16px;
            color: #FFFFFF;
        }
        
        .community-messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
        }
        
        .community-message {
            margin-bottom: 16px;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background 0.15s;
        }
        
        .community-message:hover {
            background: rgba(4, 4, 5, 0.07);
        }
        
        .community-message-header {
            display: flex;
            align-items: center;
            margin-bottom: 4px;
        }
        
        .community-message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #FFFFFF;
            margin-right: 16px;
            flex-shrink: 0;
        }
        
        .community-message-info {
            flex: 1;
        }
        
        .community-message-author {
            font-weight: 600;
            color: #FFFFFF;
            margin-right: 8px;
        }
        
        .community-message-timestamp {
            font-size: 12px;
            color: #72767D;
        }
        
        .community-message-content {
            margin-left: 56px;
            color: #DCDDDE;
            line-height: 1.375;
            word-wrap: break-word;
        }
        
        .community-input-area {
            padding: 16px;
            background: #40444B;
            border-top: 1px solid rgba(0, 0, 0, 0.2);
            flex-shrink: 0;
        }
        
        .community-input-container {
            background: #40444B;
            border-radius: 8px;
            padding: 12px;
            display: flex;
            align-items: center;
        }
        
        .community-message-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #DCDDDE;
            font-size: 16px;
            outline: none;
            resize: none;
            max-height: 200px;
            font-family: inherit;
        }
        
        .community-message-input::placeholder {
            color: #72767D;
        }
        
        .community-send-button {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            color: #FFFFFF;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            margin-left: 8px;
            transition: opacity 0.2s;
        }
        
        .community-send-button:hover {
            opacity: 0.8;
        }
        
        .community-vote-poll {
            background: #2F3136;
            border-radius: 4px;
            padding: 16px;
            margin: 8px 0;
        }
        
        .community-vote-option {
            background: #40444B;
            border-radius: 4px;
            padding: 12px;
            margin: 8px 0;
            cursor: pointer;
            transition: background 0.15s;
        }
        
        .community-vote-option:hover {
            background: #484C52;
        }
        
        .community-vote-bar {
            background: #2F3136;
            height: 24px;
            border-radius: 12px;
            overflow: hidden;
            margin-top: 8px;
            position: relative;
        }
        
        .community-vote-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            color: #FFFFFF;
            font-size: 12px;
            font-weight: 600;
            transition: width 0.3s;
        }
        
        .community-article-card {
            background: #2F3136;
            border-radius: 4px;
            padding: 16px;
            margin: 8px 0;
            cursor: pointer;
            transition: background 0.15s;
        }
        
        .community-article-card:hover {
            background: #393C43;
        }
        
        .community-article-title {
            font-weight: 600;
            color: #FFFFFF;
            margin-bottom: 4px;
        }
        
        .community-article-meta {
            font-size: 12px;
            color: #72767D;
            margin-top: 8px;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid #E5E7EB;
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-info {
            flex: 1;
        }
        
        .cart-item-name {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .cart-item-details {
            font-size: 0.875rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }
        
        .cart-item-price {
            font-weight: 600;
            color: var(--text-color);
        }
        
        .cart-total {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            margin-top: 1rem;
            border-top: 2px solid #E5E7EB;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .cart-total-label {
            color: var(--text-color);
        }
        
        .cart-total-amount {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        @media (max-width: 768px) {
            .product-modal-body {
                grid-template-columns: 1fr;
            }
            
            .product-modal-content {
                width: 95%;
                margin: 5% auto;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-header .container {
                flex-direction: column;
                gap: 1rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-page">
        <!-- Check login status -->
        <script>
            if (localStorage.getItem('isLoggedIn') !== 'true') {
                window.location.href = 'login.html';
            }
        </script>
        
        <!-- Header -->
        <div class="dashboard-header">
            <a href="index.html" class="home-icon" title="è¿”å›é¦–é ">ğŸŒ™</a>
            <div class="container">
                <div class="user-info">
                    <h1>æ­¡è¿å›ä¾†ï¼Œ<span id="usernameDisplay"></span></h1>
                    <p>ç®¡ç†æ‚¨çš„è¨‚é–±èˆ‡è¨‚å–®</p>
                </div>
                <button class="logout-button" onclick="handleLogout()">ç™»å‡º</button>
            </div>
        </div>
        
        <!-- Navigation -->
        <div class="dashboard-nav">
            <div class="container">
                <button class="nav-tab active" onclick="switchTab('orders')">ğŸ“¦ è³¼è²·è¨˜éŒ„</button>
                <button class="nav-tab" onclick="switchTab('subscription')">ğŸ’³ è¨‚é–±æ–¹æ¡ˆ</button>
                <button class="nav-tab" onclick="switchTab('addons')">ğŸ›’ åŠ è³¼å“é …</button>
                <button class="nav-tab" onclick="switchTab('community')">ğŸ’¬ åŒ¿åç¾¤èŠ</button>
            </div>
        </div>
        
        <!-- Content -->
        <div class="container">
            <!-- è³¼è²·è¨˜éŒ„ Tab -->
            <div id="orders" class="tab-content active">
                <div class="content-card">
                    <h3>è³¼è²·è¨˜éŒ„</h3>
                    
                    <div class="order-item">
                        <div class="order-header">
                            <div class="order-title">æ°´æ‰‹æœä¸»é¡Œç›’</div>
                            <div class="order-date">2026-01-01</div>
                        </div>
                        <div class="order-details">
                            è¨‚å–®ç·¨è™Ÿï¼šORD-20260101-001<br>
                            æ–¹æ¡ˆï¼šæ¯å¹´è¨‚é–±ï¼ˆ1/12ï¼‰<br>
                            ç‹€æ…‹ï¼šå·²å‡ºè²¨
                        </div>
                    </div>
                    
                    <div class="order-item">
                        <div class="order-header">
                            <div class="order-title">æ„Ÿå®˜æ¢ç´¢ä¸»é¡Œç›’</div>
                            <div class="order-date">2025-12-01</div>
                        </div>
                        <div class="order-details">
                            è¨‚å–®ç·¨è™Ÿï¼šORD-20251201-001<br>
                            æ–¹æ¡ˆï¼šæ¯å¹´è¨‚é–±ï¼ˆ12/12ï¼‰<br>
                            ç‹€æ…‹ï¼šå·²å®Œæˆ
                        </div>
                    </div>
                    
                    <div class="order-item">
                        <div class="order-header">
                            <div class="order-title">è¼•åº¦ BDSM å…¥é–€ä¸»é¡Œç›’</div>
                            <div class="order-date">2025-11-01</div>
                        </div>
                        <div class="order-details">
                            è¨‚å–®ç·¨è™Ÿï¼šORD-20251101-001<br>
                            æ–¹æ¡ˆï¼šæ¯å¹´è¨‚é–±ï¼ˆ11/12ï¼‰<br>
                            ç‹€æ…‹ï¼šå·²å®Œæˆ
                        </div>
                    </div>
                    
                    <div class="order-item">
                        <div class="order-header">
                            <div class="order-title">æµªæ¼«æ°›åœä¸»é¡Œç›’</div>
                            <div class="order-date">2025-10-01</div>
                        </div>
                        <div class="order-details">
                            è¨‚å–®ç·¨è™Ÿï¼šORD-20251001-001<br>
                            æ–¹æ¡ˆï¼šæ¯å¹´è¨‚é–±ï¼ˆ10/12ï¼‰<br>
                            ç‹€æ…‹ï¼šå·²å®Œæˆ
                        </div>
                    </div>
                    
                    <div class="order-item">
                        <div class="order-header">
                            <div class="order-title">è²“å’ªä¸»é¡Œç›’</div>
                            <div class="order-date">2025-09-15</div>
                        </div>
                        <div class="order-details">
                            è¨‚å–®ç·¨è™Ÿï¼šORD-20250915-001<br>
                            æ–¹æ¡ˆï¼šå–®æ¬¡è³¼è²·<br>
                            ç‹€æ…‹ï¼šå·²å®Œæˆ
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- è¨‚é–±æ–¹æ¡ˆ Tab -->
            <div id="subscription" class="tab-content">
                <div class="content-card">
                    <h3>ç›®å‰è¨‚é–±æ–¹æ¡ˆ</h3>
                    
                    <div class="subscription-card">
                        <div class="subscription-status">
                            <div>
                                <h4 style="margin: 0; background: linear-gradient(135deg, var(--primary-color) 0%, var(--red-color) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">æ¯å¹´è¨‚é–±</h4>
                            </div>
                            <span class="status-badge status-active">é€²è¡Œä¸­</span>
                        </div>
                        
                        <div class="subscription-info">
                            <p><strong>é–‹å§‹æ—¥æœŸï¼š</strong>2025-01-01</p>
                            <p><strong>çµæŸæ—¥æœŸï¼š</strong>2025-12-31</p>
                            <p><strong>å·²æ”¶åˆ°ï¼š</strong>12 / 12 ç›’</p>
                            <p><strong>ä¸‹æ¬¡å‡ºè²¨ï¼š</strong>2026-02-01</p>
                        </div>
                        
                        <div class="action-buttons">
                            <button class="btn-primary" onclick="changeSubscription()">è®Šæ›´æ–¹æ¡ˆ</button>
                            <button class="btn-secondary" onclick="cancelSubscription()">å–æ¶ˆè¨‚é–±</button>
                        </div>
                    </div>
                </div>
                
                <div class="content-card">
                    <h3>å¯é¸æ–¹æ¡ˆ</h3>
                    
                    <div class="pricing-grid" style="margin-top: 1rem;">
                        <div class="pricing-card">
                            <h3>å–®æ¬¡è³¼è²·</h3>
                            <div class="price">é¦–å¹´é™å®š</div>
                            <p class="price-desc">é«”é©—ä¸€æ¬¡ä¸»é¡Œç›’</p>
                            <ul class="pricing-features">
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">ä¸€å¥—ä¸»é¡Œæœè£</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">2-3 å€‹é…ä»¶/é“å…·</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">æ½¤æ»‘æ¶²</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">æƒ…å¢ƒæŒ‡å—å¡</span></li>
                                <li><span class="feature-icon cross">âœ—</span> <span class="feature-text">ç¤¾ç¾¤æœƒå“¡è³‡æ ¼</span></li>
                                <li><span class="feature-icon cross">âœ—</span> <span class="feature-text">å°ˆå®¶å°ˆæ¬„å„ªå…ˆé–±è®€</span></li>
                                <li><span class="feature-icon cross">âœ—</span> <span class="feature-text">å¯ç¥¨é¸ä¸‹å€‹æœˆä¸»é¡Œ</span></li>
                            </ul>
                            <button class="btn-secondary" onclick="selectPlan('single')">é¸æ“‡æ­¤æ–¹æ¡ˆ</button>
                        </div>
                        
                        <div class="pricing-card featured">
                            <div class="bonus-badge-top">12æœˆåŠ é€1å€‹æœˆ</div>
                            <h3>æ¯å¹´è¨‚é–±</h3>
                            <div class="price">12 å€‹æœˆ<span class="bonus-month">+1</span></div>
                            <p class="price-desc">å…¨å¹´äº«å—ä¸»é¡Œç›’</p>
                            <ul class="pricing-features">
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">12 å¥—ä¸»é¡Œæœè£</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">24-36 å€‹é…ä»¶/é“å…·</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">æ½¤æ»‘æ¶² Ã— 12</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">æƒ…å¢ƒæŒ‡å—å¡ Ã— 12</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">ç¤¾ç¾¤æœƒå“¡è³‡æ ¼</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">å°ˆå®¶å°ˆæ¬„å„ªå…ˆé–±è®€</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">å¯ç¥¨é¸ä¸‹å€‹æœˆä¸»é¡Œ</span></li>
                            </ul>
                            <button class="btn-primary" onclick="selectPlan('yearly')">é¸æ“‡æ­¤æ–¹æ¡ˆ</button>
                        </div>
                        
                        <div class="pricing-card">
                            <h3>æ¯å­£è¨‚é–±</h3>
                            <div class="price">3 å€‹æœˆ</div>
                            <p class="price-desc">æ¯å­£æ”¶åˆ°ä¸åŒä¸»é¡Œç›’</p>
                            <ul class="pricing-features">
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">3 å¥—ä¸»é¡Œæœè£</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">6-9 å€‹é…ä»¶/é“å…·</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">æ½¤æ»‘æ¶² Ã— 3</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">æƒ…å¢ƒæŒ‡å—å¡ Ã— 3</span></li>
                                <li><span class="feature-icon">âœ“</span> <span class="feature-text">ç¤¾ç¾¤æœƒå“¡è³‡æ ¼</span></li>
                                <li><span class="feature-icon cross">âœ—</span> <span class="feature-text">å°ˆå®¶å°ˆæ¬„å„ªå…ˆé–±è®€</span></li>
                                <li><span class="feature-icon cross">âœ—</span> <span class="feature-text">å¯ç¥¨é¸ä¸‹å€‹æœˆä¸»é¡Œ</span></li>
                            </ul>
                            <button class="btn-secondary" onclick="selectPlan('quarterly')">é¸æ“‡æ­¤æ–¹æ¡ˆ</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- åŠ è³¼å“é … Tab -->
            <div id="addons" class="tab-content">
                <div class="content-card">
                    <h3>åŠ è³¼å“é …</h3>
                    <p style="color: var(--text-light); margin-bottom: 1.5rem;">é»æ“Šé¡åˆ¥å±•é–‹å•†å“ï¼Œé»æ“Šå•†å“æŸ¥çœ‹è©³æƒ…ä¸¦é¸æ“‡æ•¸é‡</p>
                    
                    <div id="categoriesContainer">
                        <!-- Categories will be dynamically generated -->
                    </div>
                </div>
                
                <!-- è³¼ç‰©è»Šæ‘˜è¦ -->
                <div class="content-card" id="cartSummary" style="display: none;">
                    <h3>è³¼ç‰©è»Š</h3>
                    <div class="cart-summary" id="cartItems">
                        <!-- Cart items will be dynamically added here -->
                    </div>
                    <div style="margin-top: 1.5rem; text-align: center;">
                        <button class="btn-primary" style="padding: 1rem 3rem;" onclick="confirmPurchase()">ç¢ºèªåŠ è³¼</button>
                    </div>
                </div>
            </div>
            
            <!-- åŒ¿åç¾¤èŠ Tab -->
            <div id="community" class="tab-content">
                <div class="community-page-embedded">
                    <!-- Sidebar -->
                    <div class="community-sidebar">
                        <div class="community-server-header">
                            <div class="community-server-name">ğŸŒ™ LunaPlay ç¤¾ç¾¤</div>
                        </div>
                        
                        <div class="community-channels-container">
                            <div class="community-channel-category">
                                <div class="community-category-header">ğŸ“¢ å®˜æ–¹é »é“</div>
                                <div class="community-channel-item active" onclick="switchCommunityChannel('announcements')">
                                    <span class="community-channel-icon">ğŸ“¢</span>
                                    <span class="community-channel-name">å®˜æ–¹å…¬å‘Š</span>
                                </div>
                            </div>
                            
                            <div class="community-channel-category">
                                <div class="community-category-header">ğŸ’¬ ç¤¾ç¾¤é »é“</div>
                                <div class="community-channel-item" onclick="switchCommunityChannel('chat')">
                                    <span class="community-channel-icon">ğŸ’¬</span>
                                    <span class="community-channel-name">ç©å®¶åŒ¿åèŠå¤©</span>
                                </div>
                                <div class="community-channel-item" onclick="switchCommunityChannel('forum')">
                                    <span class="community-channel-icon">ğŸ“</span>
                                    <span class="community-channel-name">è«–å£‡</span>
                                </div>
                            </div>
                            
                            <div class="community-channel-category">
                                <div class="community-category-header">ğŸ“š å­¸ç¿’é »é“</div>
                                <div class="community-channel-item" onclick="switchCommunityChannel('learning')">
                                    <span class="community-channel-icon">ğŸ‘¨â€âš•ï¸</span>
                                    <span class="community-channel-name">å°ˆå®¶æ•™å­¸</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Main Content -->
                    <div class="community-main-content">
                        <div class="community-channel-header">
                            <span class="community-channel-header-icon" id="communityChannelHeaderIcon">ğŸ“¢</span>
                            <span class="community-channel-header-name" id="communityChannelHeaderName">å®˜æ–¹å…¬å‘Š</span>
                        </div>
                        
                        <div class="community-messages-container" id="communityMessagesContainer">
                            <!-- Messages will be dynamically loaded here -->
                        </div>
                        
                        <div class="community-input-area">
                            <div class="community-input-container">
                                <textarea 
                                    class="community-message-input" 
                                    id="communityMessageInput" 
                                    placeholder="è¼¸å…¥è¨Šæ¯..." 
                                    rows="1"
                                    onkeydown="handleCommunityKeyDown(event)"
                                ></textarea>
                                <button class="community-send-button" id="communitySendButton" onclick="sendCommunityMessage()">ç™¼é€</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å•†å“è©³æƒ…æ¨¡æ€çª—å£ -->
            <div id="productModal" class="product-modal">
                <div class="product-modal-content">
                    <div class="product-modal-header">
                        <h2 id="modalProductTitle">å•†å“è©³æƒ…</h2>
                        <span class="close" onclick="closeProductModal()" style="font-size: 2rem; cursor: pointer; color: var(--text-light);">&times;</span>
                    </div>
                    <div class="product-modal-body">
                        <div class="product-image-container" id="modalProductImage">
                            <div class="product-image">ğŸ›¡ï¸</div>
                        </div>
                        <div class="product-info">
                            <div class="product-title" id="modalProductName">å•†å“åç¨±</div>
                            <div class="product-price" id="modalProductPrice">NT$ 0</div>
                            
                            <div class="product-specs" id="modalProductSpecs">
                                <!-- Specs will be dynamically added -->
                            </div>
                            
                            <div class="quantity-selector">
                                <button class="quantity-button" onclick="decreaseQuantity()">âˆ’</button>
                                <input type="number" class="quantity-input" id="productQuantity" value="1" min="1" max="99" onchange="updateTotalPrice()">
                                <button class="quantity-button" onclick="increaseQuantity()">+</button>
                            </div>
                            
                            <div class="total-price">
                                å°è¨ˆï¼š<span id="productSubtotal">NT$ 0</span>
                            </div>
                            
                            <button class="btn-primary" style="width: 100%; padding: 1rem;" onclick="addToCart()">åŠ å…¥è³¼ç‰©è»Š</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Display username
        const username = localStorage.getItem('username') || 'æœƒå“¡';
        document.getElementById('usernameDisplay').textContent = username;
        
        // Shopping cart
        let shoppingCart = JSON.parse(localStorage.getItem('shoppingCart') || '[]');
        let currentProduct = null;
        
        // Product data organized by categories
        const productCategories = {
            'safety': {
                name: 'å®‰å…¨ç”¨å“',
                icon: 'ğŸ›¡ï¸',
                products: {
                    'condoms-standard': {
                        name: 'æ¨™æº–å‹ä¿éšªå¥—',
                        image: 'ğŸ›¡ï¸',
                        price: 299,
                        specs: [
                            { label: 'å“ç‰Œ', value: 'å¤šå“ç‰Œå¯é¸' },
                            { label: 'æè³ª', value: 'å¤©ç„¶ä¹³è† ' },
                            { label: 'è¦æ ¼', value: '12å…¥ / 24å…¥ / 36å…¥' },
                            { label: 'å°ºå¯¸', value: 'æ¨™æº–å°ºå¯¸' },
                            { label: 'ç‰¹è‰²', value: 'è¶…è–„ã€æŒä¹…' }
                        ]
                    },
                    'condoms-large': {
                        name: 'å¤§å°ºå¯¸ä¿éšªå¥—',
                        image: 'ğŸ›¡ï¸',
                        price: 329,
                        specs: [
                            { label: 'å“ç‰Œ', value: 'å¤šå“ç‰Œå¯é¸' },
                            { label: 'æè³ª', value: 'å¤©ç„¶ä¹³è†  / èšæ°¨é…¯' },
                            { label: 'è¦æ ¼', value: '12å…¥ / 24å…¥' },
                            { label: 'å°ºå¯¸', value: 'å¤§å°ºå¯¸' },
                            { label: 'ç‰¹è‰²', value: 'è¶…è–„ã€æŒä¹…ã€é¡†ç²’ã€èºç´‹' }
                        ]
                    },
                    'condoms-special': {
                        name: 'ç‰¹æ®ŠåŠŸèƒ½ä¿éšªå¥—',
                        image: 'ğŸ›¡ï¸',
                        price: 399,
                        specs: [
                            { label: 'å“ç‰Œ', value: 'å¤šå“ç‰Œå¯é¸' },
                            { label: 'æè³ª', value: 'èšæ°¨é…¯' },
                            { label: 'è¦æ ¼', value: '12å…¥' },
                            { label: 'å°ºå¯¸', value: 'æ¨™æº– / å¤§å°ºå¯¸' },
                            { label: 'ç‰¹è‰²', value: 'é¡†ç²’ã€èºç´‹ã€æº«ç†±ã€æ¶¼æ„Ÿ' }
                        ]
                    }
                }
            },
            'lubricant': {
                name: 'æ½¤æ»‘ç”¨å“',
                icon: 'ğŸ’§',
                products: {
                    'lubricant-water': {
                        name: 'æ°´åŸºæ½¤æ»‘æ¶²',
                        image: 'ğŸ’§',
                        imagePath: 'assets/é¦™ç²¾.webp',
                        price: 399,
                        specs: [
                            { label: 'å®¹é‡', value: '50ml / 100ml / 200ml' },
                            { label: 'é¡å‹', value: 'æ°´åŸº' },
                            { label: 'ç‰¹è‰²', value: 'æŒä¹…ã€ç„¡å‘³ã€æ˜“æ¸…æ´—' },
                            { label: 'é©ç”¨', value: 'ä¸€èˆ¬ä½¿ç”¨' },
                            { label: 'ä¿å­˜æœŸé™', value: '3å¹´' }
                        ]
                    },
                    'lubricant-silicone': {
                        name: 'çŸ½åŸºæ½¤æ»‘æ¶²',
                        image: 'ğŸ’§',
                        imagePath: 'assets/é¦™ç²¾.webp',
                        price: 499,
                        specs: [
                            { label: 'å®¹é‡', value: '50ml / 100ml' },
                            { label: 'é¡å‹', value: 'çŸ½åŸº' },
                            { label: 'ç‰¹è‰²', value: 'è¶…æŒä¹…ã€ä¸ä¹¾ç‡¥' },
                            { label: 'é©ç”¨', value: 'ä¸€èˆ¬ä½¿ç”¨ / å¾Œåº­å°ˆç”¨' },
                            { label: 'ä¿å­˜æœŸé™', value: '3å¹´' }
                        ]
                    },
                    'lubricant-special': {
                        name: 'ç‰¹æ®ŠåŠŸèƒ½æ½¤æ»‘æ¶²',
                        image: 'ğŸ’§',
                        imagePath: 'assets/é¦™ç²¾.webp',
                        price: 599,
                        specs: [
                            { label: 'å®¹é‡', value: '50ml / 100ml' },
                            { label: 'é¡å‹', value: 'æ°´åŸº / çŸ½åŸº' },
                            { label: 'ç‰¹è‰²', value: 'æº«ç†±ã€æ¶¼æ„Ÿã€å»¶æ™‚' },
                            { label: 'é©ç”¨', value: 'ä¸€èˆ¬ä½¿ç”¨ / å¾Œåº­å°ˆç”¨' },
                            { label: 'ä¿å­˜æœŸé™', value: '3å¹´' }
                        ]
                    },
                    'massage-oil': {
                        name: 'æŒ‰æ‘©æ²¹',
                        image: 'ğŸ«§',
                        imagePath: 'assets/é¦™ç²¾.webp',
                        price: 499,
                        specs: [
                            { label: 'å®¹é‡', value: '100ml / 200ml' },
                            { label: 'æˆåˆ†', value: 'å¤©ç„¶æ¤ç‰©ç²¾æ²¹' },
                            { label: 'é¦™å‘³', value: 'è–°è¡£è‰ / ç«ç‘° / ç„¡é¦™' },
                            { label: 'ç‰¹è‰²', value: 'æº«ç†±ã€æ»‹æ½¤ã€æ˜“å¸æ”¶' },
                            { label: 'ä¿å­˜æœŸé™', value: '2å¹´' }
                        ]
                    }
                }
            },
            'cleaning': {
                name: 'æ¸…æ½”ç”¨å“',
                icon: 'ğŸ§´',
                products: {
                    'cleaning-spray': {
                        name: 'æ¸…æ½”å™´éœ§',
                        image: 'ğŸ§´',
                        price: 199,
                        specs: [
                            { label: 'å®¹é‡', value: '150ml' },
                            { label: 'æˆåˆ†', value: 'å¤©ç„¶æŠ—èŒé…æ–¹' },
                            { label: 'ç”¨é€”', value: 'å¿«é€Ÿæ¸…æ½”ã€é™¤èŒ' },
                            { label: 'ç‰¹è‰²', value: 'ç„¡é…’ç²¾ã€ä¸åˆºæ¿€' },
                            { label: 'ä¿å­˜æœŸé™', value: '3å¹´' }
                        ]
                    },
                    'toy-cleaner': {
                        name: 'ç©å…·å°ˆç”¨æ¸…æ½”æ¶²',
                        image: 'ğŸ§½',
                        price: 299,
                        specs: [
                            { label: 'å®¹é‡', value: '200ml' },
                            { label: 'æˆåˆ†', value: 'å°ˆç”¨æ¸…æ½”é…æ–¹' },
                            { label: 'é©ç”¨', value: 'çŸ½è† ã€TPEã€ABSæè³ª' },
                            { label: 'ç‰¹è‰²', value: 'æ·±åº¦æ¸…æ½”ã€é™¤èŒã€é™¤å‘³' },
                            { label: 'ä¿å­˜æœŸé™', value: '3å¹´' }
                        ]
                    },
                    'cleaning-wipes': {
                        name: 'æ¸…æ½”æ¿•å·¾',
                        image: 'ğŸ§»',
                        price: 149,
                        specs: [
                            { label: 'è¦æ ¼', value: '20ç‰‡ / 40ç‰‡' },
                            { label: 'æˆåˆ†', value: 'å¤©ç„¶æŠ—èŒé…æ–¹' },
                            { label: 'ç”¨é€”', value: 'å¿«é€Ÿæ¸…æ½”ã€é™¤èŒ' },
                            { label: 'ç‰¹è‰²', value: 'æ–¹ä¾¿æ”œå¸¶ã€å³ç”¨å³ä¸Ÿ' },
                            { label: 'ä¿å­˜æœŸé™', value: '2å¹´' }
                        ]
                    }
                }
            },
            'toys': {
                name: 'å…¶ä»–é“å…·',
                icon: 'ğŸ',
                products: {
                    'toys-basic': {
                        name: 'åŸºç¤æƒ…è¶£é“å…·',
                        image: 'ğŸ',
                        imagePath: 'assets/æŸç¸›æ‰‹éŠ¬.jpeg',
                        price: 599,
                        specs: [
                            { label: 'é¡å‹', value: 'åŸºç¤æ¬¾å¼' },
                            { label: 'æè³ª', value: 'é†«ç™‚ç´šçŸ½è† ' },
                            { label: 'å°ºå¯¸', value: 'æ¨™æº–å°ºå¯¸' },
                            { label: 'ç‰¹è‰²', value: 'éœéŸ³ã€é˜²æ°´' },
                            { label: 'ä¿å›º', value: '1å¹´ä¿å›º' }
                        ]
                    },
                    'toys-advanced': {
                        name: 'é€²éšæƒ…è¶£é“å…·',
                        image: 'ğŸ',
                        imagePath: 'assets/é …åœˆ.webp',
                        price: 1299,
                        specs: [
                            { label: 'é¡å‹', value: 'é€²éšæ¬¾å¼' },
                            { label: 'æè³ª', value: 'é†«ç™‚ç´šçŸ½è† ' },
                            { label: 'å°ºå¯¸', value: 'å¤šç¨®å°ºå¯¸' },
                            { label: 'ç‰¹è‰²', value: 'éœéŸ³ã€é˜²æ°´ã€å¯èª¿é€Ÿã€å¤šæ¨¡å¼' },
                            { label: 'ä¿å›º', value: '1å¹´ä¿å›º' }
                        ]
                    },
                    'toys-premium': {
                        name: 'é«˜ç´šæƒ…è¶£é“å…·',
                        image: 'ğŸ',
                        imagePath: 'assets/BDSM.webp',
                        price: 1999,
                        specs: [
                            { label: 'é¡å‹', value: 'é«˜ç´šæ¬¾å¼' },
                            { label: 'æè³ª', value: 'é†«ç™‚ç´šçŸ½è† ã€ä¸é½é‹¼' },
                            { label: 'å°ºå¯¸', value: 'å¤šç¨®å°ºå¯¸' },
                            { label: 'ç‰¹è‰²', value: 'éœéŸ³ã€é˜²æ°´ã€å¯èª¿é€Ÿã€å¤šæ¨¡å¼ã€APPæ§åˆ¶' },
                            { label: 'ä¿å›º', value: '2å¹´ä¿å›º' }
                        ]
                    }
                }
            }
        };
        
        // Flatten products for easy lookup
        const products = {};
        Object.keys(productCategories).forEach(categoryId => {
            const category = productCategories[categoryId];
            Object.keys(category.products).forEach(productId => {
                products[productId] = category.products[productId];
            });
        });
        
        function switchTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Initialize community if needed
            if (tabName === 'community') {
                setTimeout(() => {
                    loadCommunityMessages('announcements');
                    // Auto-resize textarea
                    const messageInput = document.getElementById('communityMessageInput');
                    if (messageInput) {
                        messageInput.addEventListener('input', function() {
                            this.style.height = 'auto';
                            this.style.height = this.scrollHeight + 'px';
                        });
                    }
                }, 100);
            }
            
            // Update cart display if switching to addons tab
            if (tabName === 'addons') {
                updateCartDisplay();
            }
        }
        
        function handleLogout() {
            if (confirm('ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ')) {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('username');
                localStorage.removeItem('loginTime');
                window.location.href = 'index.html';
            }
        }
        
        function changeSubscription() {
            switchTab('subscription');
            document.querySelectorAll('.nav-tab')[1].classList.add('active');
            document.querySelectorAll('.nav-tab')[0].classList.remove('active');
        }
        
        function cancelSubscription() {
            if (confirm('ç¢ºå®šè¦å–æ¶ˆè¨‚é–±å—ï¼Ÿå–æ¶ˆå¾Œå°‡ç„¡æ³•ç¹¼çºŒæ”¶åˆ°ä¸»é¡Œç›’ã€‚')) {
                alert('è¨‚é–±å·²å–æ¶ˆã€‚\n\nï¼ˆæ­¤ç‚º Demo ç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½éœ€é€£æ¥å¾Œç«¯ç³»çµ±ï¼‰');
            }
        }
        
        function selectPlan(planType) {
            if (confirm('ç¢ºå®šè¦è®Šæ›´ç‚ºæ­¤æ–¹æ¡ˆå—ï¼Ÿ')) {
                alert('æ–¹æ¡ˆå·²è®Šæ›´ï¼\n\nï¼ˆæ­¤ç‚º Demo ç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½éœ€é€£æ¥å¾Œç«¯ç³»çµ±ï¼‰');
            }
        }
        
        function showProductDetail(productId) {
            currentProduct = products[productId];
            if (!currentProduct) return;
            
            // Update modal content
            document.getElementById('modalProductTitle').textContent = currentProduct.name;
            document.getElementById('modalProductName').textContent = currentProduct.name;
            
            // Update product image
            const imageContainer = document.getElementById('modalProductImage');
            if (currentProduct.imagePath) {
                imageContainer.innerHTML = `<img src="${currentProduct.imagePath}" alt="${currentProduct.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"><div style="display: none; font-size: 8rem; width: 100%; height: 100%; align-items: center; justify-content: center; color: var(--text-light);">${currentProduct.image}</div>`;
            } else {
                imageContainer.innerHTML = `<div class="product-image" style="font-size: 8rem; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; color: var(--text-light);">${currentProduct.image}</div>`;
            }
            
            document.getElementById('modalProductPrice').textContent = `NT$ ${currentProduct.price}`;
            document.getElementById('productQuantity').value = 1;
            
            // Update specs
            const specsContainer = document.getElementById('modalProductSpecs');
            specsContainer.innerHTML = '';
            currentProduct.specs.forEach(spec => {
                const specItem = document.createElement('div');
                specItem.className = 'spec-item';
                specItem.innerHTML = `
                    <span class="spec-label">${spec.label}ï¼š</span>
                    <span class="spec-value">${spec.value}</span>
                `;
                specsContainer.appendChild(specItem);
            });
            
            // Update total price
            updateTotalPrice();
            
            // Show modal
            document.getElementById('productModal').style.display = 'block';
        }
        
        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
            currentProduct = null;
        }
        
        function increaseQuantity() {
            const input = document.getElementById('productQuantity');
            const current = parseInt(input.value) || 1;
            if (current < 99) {
                input.value = current + 1;
                updateTotalPrice();
            }
        }
        
        function decreaseQuantity() {
            const input = document.getElementById('productQuantity');
            const current = parseInt(input.value) || 1;
            if (current > 1) {
                input.value = current - 1;
                updateTotalPrice();
            }
        }
        
        function updateTotalPrice() {
            if (!currentProduct) return;
            
            const quantity = parseInt(document.getElementById('productQuantity').value) || 1;
            const subtotal = currentProduct.price * quantity;
            document.getElementById('productSubtotal').textContent = `NT$ ${subtotal.toLocaleString()}`;
        }
        
        function addToCart() {
            if (!currentProduct) return;
            
            const quantity = parseInt(document.getElementById('productQuantity').value) || 1;
            
            // Check if product already in cart
            const existingIndex = shoppingCart.findIndex(item => item.id === Object.keys(products).find(key => products[key] === currentProduct));
            
            if (existingIndex >= 0) {
                // Update quantity
                shoppingCart[existingIndex].quantity += quantity;
            } else {
                // Add new item
                const productId = Object.keys(products).find(key => products[key] === currentProduct);
                shoppingCart.push({
                    id: productId,
                    name: currentProduct.name,
                    image: currentProduct.image,
                    price: currentProduct.price,
                    quantity: quantity
                });
            }
            
            // Save to localStorage
            localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
            
            // Update cart display
            updateCartDisplay();
            
            // Close modal
            closeProductModal();
            
            // Show notification
            alert(`å·²å°‡ ${currentProduct.name} x${quantity} åŠ å…¥è³¼ç‰©è»Šï¼`);
        }
        
        function updateCartDisplay() {
            const cartSummary = document.getElementById('cartSummary');
            const cartItems = document.getElementById('cartItems');
            
            if (shoppingCart.length === 0) {
                cartSummary.style.display = 'none';
                return;
            }
            
            cartSummary.style.display = 'block';
            
            // Clear existing items
            cartItems.innerHTML = '';
            
            let total = 0;
            
            shoppingCart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'cart-item';
                cartItem.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.image} ${item.name}</div>
                        <div class="cart-item-details">æ•¸é‡ï¼š${item.quantity} Ã— NT$ ${item.price.toLocaleString()}</div>
                    </div>
                    <div class="cart-item-price">NT$ ${itemTotal.toLocaleString()}</div>
                    <button onclick="removeFromCart(${index})" style="margin-left: 1rem; background: #FEE2E2; color: #991B1B; border: none; padding: 0.5rem; border-radius: 0.25rem; cursor: pointer;">ç§»é™¤</button>
                `;
                cartItems.appendChild(cartItem);
            });
            
            // Add total
            const totalDiv = document.createElement('div');
            totalDiv.className = 'cart-total';
            totalDiv.innerHTML = `
                <span class="cart-total-label">ç¸½è¨ˆï¼š</span>
                <span class="cart-total-amount">NT$ ${total.toLocaleString()}</span>
            `;
            cartItems.appendChild(totalDiv);
        }
        
        function removeFromCart(index) {
            shoppingCart.splice(index, 1);
            localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
            updateCartDisplay();
        }
        
        function confirmPurchase() {
            if (shoppingCart.length === 0) {
                alert('è³¼ç‰©è»Šæ˜¯ç©ºçš„ï¼');
                return;
            }
            
            const total = shoppingCart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const itemsList = shoppingCart.map(item => `${item.name} x${item.quantity}`).join('\n');
            
            if (confirm(`ç¢ºèªåŠ è³¼ä»¥ä¸‹å•†å“ï¼Ÿ\n\n${itemsList}\n\nç¸½è¨ˆï¼šNT$ ${total.toLocaleString()}`)) {
                alert('æ„Ÿè¬æ‚¨çš„è¨‚è³¼ï¼\n\nï¼ˆæ­¤ç‚º Demo ç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½éœ€é€£æ¥å¾Œç«¯ç³»çµ±ï¼‰');
                shoppingCart = [];
                localStorage.setItem('shoppingCart', JSON.stringify(shoppingCart));
                updateCartDisplay();
            }
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('productModal');
            if (event.target == modal) {
                closeProductModal();
            }
        }
        
        // Initialize categories display
        function initializeCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            Object.keys(productCategories).forEach(categoryId => {
                const category = productCategories[categoryId];
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-container';
                
                const header = document.createElement('div');
                header.className = 'category-header';
                header.onclick = () => toggleCategory(categoryId);
                header.innerHTML = `
                    <div class="category-title">
                        <span class="category-icon">${category.icon}</span>
                        <span>${category.name}</span>
                    </div>
                    <span class="category-arrow">â–¼</span>
                `;
                
                const productsDiv = document.createElement('div');
                productsDiv.className = 'category-products';
                productsDiv.id = `products-${categoryId}`;
                
                Object.keys(category.products).forEach(productId => {
                    const product = category.products[productId];
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.onclick = () => showProductDetail(productId);
                    
                    let imageHTML = '';
                    if (product.imagePath) {
                        imageHTML = `<img src="${product.imagePath}" alt="${product.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"><div style="display: none; font-size: 2.5rem; width: 100%; height: 100%; align-items: center; justify-content: center;">${product.image}</div>`;
                    } else {
                        imageHTML = `<div style="font-size: 2.5rem; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">${product.image}</div>`;
                    }
                    
                    productCard.innerHTML = `
                        <div class="product-image">${imageHTML}</div>
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">NT$ ${product.price.toLocaleString()}</div>
                    `;
                    productsDiv.appendChild(productCard);
                });
                
                categoryDiv.appendChild(header);
                categoryDiv.appendChild(productsDiv);
                container.appendChild(categoryDiv);
            });
        }
        
        function toggleCategory(categoryId) {
            const productsDiv = document.getElementById(`products-${categoryId}`);
            const header = event.currentTarget;
            
            if (productsDiv.classList.contains('expanded')) {
                productsDiv.classList.remove('expanded');
                header.classList.remove('active');
            } else {
                // Close all other categories
                document.querySelectorAll('.category-products').forEach(div => {
                    div.classList.remove('expanded');
                });
                document.querySelectorAll('.category-header').forEach(h => {
                    h.classList.remove('active');
                });
                
                // Open this category
                productsDiv.classList.add('expanded');
                header.classList.add('active');
            }
        }
        
        // Initialize cart display
        updateCartDisplay();
        
        // Initialize categories on page load
        initializeCategories();
        
        // Community functions
        let currentCommunityChannel = 'announcements';
        const communityUsername = localStorage.getItem('username') || 'åŒ¿åç”¨æˆ¶';
        
        const communityChannelData = {
            announcements: {
                icon: 'ğŸ“¢',
                name: 'å®˜æ–¹å…¬å‘Š',
                messages: [
                    {
                        author: 'LunaPlay å®˜æ–¹',
                        avatar: 'ğŸŒ™',
                        timestamp: '2024-01-15 10:00',
                        content: 'æ­¡è¿ä¾†åˆ° LunaPlay æœˆä¹‹ç›’å®˜æ–¹ç¤¾ç¾¤ï¼',
                        type: 'text'
                    },
                    {
                        author: 'LunaPlay å®˜æ–¹',
                        avatar: 'ğŸŒ™',
                        timestamp: '2024-01-15 10:05',
                        content: 'æœ¬æœˆä¸»é¡ŒæŠ•ç¥¨é–‹å§‹äº†ï¼è«‹åœ¨ä¸‹æ–¹æŠ•ç¥¨é¸æ“‡ä¸‹å€‹æœˆçš„ä¸»é¡Œã€‚',
                        type: 'text'
                    },
                    {
                        author: 'LunaPlay å®˜æ–¹',
                        avatar: 'ğŸŒ™',
                        timestamp: '2024-01-15 10:10',
                        content: 'ä¸»é¡ŒæŠ•ç¥¨',
                        type: 'vote',
                        options: [
                            { name: 'ğŸ–ï¸ å¤æ—¥æµ·ç˜ä¸»é¡Œ', votes: 65, total: 100 },
                            { name: 'ğŸ­ å¾©å¤é¢¨æƒ…ä¸»é¡Œ', votes: 35, total: 100 }
                        ]
                    }
                ]
            },
            chat: {
                icon: 'ğŸ’¬',
                name: 'ç©å®¶åŒ¿åèŠå¤©',
                messages: [
                    {
                        author: 'åŒ¿åç”¨æˆ¶ #1234',
                        avatar: 'ğŸ‘¤',
                        timestamp: '2024-01-15 09:30',
                        content: 'æœ‰äººè©¦éæ°´æ‰‹æœä¸»é¡Œç›’å—ï¼Ÿæƒ³è½è½å¿ƒå¾—ï½'
                    },
                    {
                        author: 'åŒ¿åç”¨æˆ¶ #5678',
                        avatar: 'ğŸ‘¤',
                        timestamp: '2024-01-15 09:35',
                        content: 'æˆ‘è©¦éï¼æœè£è³ªæ„Ÿå¾ˆå¥½ï¼Œé…ä»¶ä¹Ÿå¾ˆå¯¦ç”¨ ğŸ‘'
                    },
                    {
                        author: 'åŒ¿åç”¨æˆ¶ #9012',
                        avatar: 'ğŸ‘¤',
                        timestamp: '2024-01-15 09:40',
                        content: 'æƒ…å¢ƒæŒ‡å—å¡å¾ˆè©³ç´°ï¼Œç¬¬ä¸€æ¬¡å˜—è©¦ä¹Ÿä¸ç”¨æ“”å¿ƒ'
                    }
                ]
            },
            forum: {
                icon: 'ğŸ“',
                name: 'è«–å£‡',
                messages: [
                    {
                        author: 'åŒ¿åç”¨æˆ¶ #3456',
                        avatar: 'ğŸ‘¤',
                        timestamp: '2024-01-14 20:00',
                        content: 'ã€å¿ƒå¾—åˆ†äº«ã€‘ã€Œæ°´æ‰‹æœä¸»é¡Œç›’ã€é–‹ç®±å¿ƒå¾—\n\næœè£è³ªæ„Ÿå¾ˆå¥½ï¼Œæè³ªæŸ”è»Ÿèˆ’é©ï¼Œé…ä»¶ä¹Ÿå¾ˆå¯¦ç”¨ã€‚æƒ…å¢ƒæŒ‡å—å¡å¾ˆè©³ç´°ï¼Œæä¾›äº†å¾ˆå¤šå¯¦ç”¨çš„å»ºè­°ã€‚æ•´é«”ä¾†èªªéå¸¸æ»¿æ„ï¼Œæ¨è–¦çµ¦æƒ³è¦å˜—è©¦è§’è‰²æ‰®æ¼”ä¸»é¡Œçš„æœ‹å‹ï¼'
                    },
                    {
                        author: 'åŒ¿åç”¨æˆ¶ #7890',
                        avatar: 'ğŸ‘¤',
                        timestamp: '2024-01-14 18:00',
                        content: 'ã€åŒ¿åå•ç­”ã€‘Q: å¦‚ä½•èˆ‡ä¼´ä¾¶è¨è«–å˜—è©¦æ–°ä¸»é¡Œï¼Ÿ\n\nA: å»ºè­°å¾è¼•é¬†çš„å°è©±é–‹å§‹ï¼Œå¯ä»¥å…ˆåˆ†äº«æ„Ÿèˆˆè¶£çš„ä¸»é¡Œï¼Œè®“å°æ–¹çŸ¥é“ä½ çš„æƒ³æ³•ã€‚é¸æ“‡ä¸€å€‹æ”¾é¬†çš„æ™‚åˆ»ï¼Œç”¨é–‹æ”¾çš„æ…‹åº¦æºé€šï¼Œä¸è¦çµ¦å°æ–¹å£“åŠ›ã€‚'
                    },
                    {
                        author: 'åŒ¿åç”¨æˆ¶ #2345',
                        avatar: 'ğŸ‘¤',
                        timestamp: '2024-01-14 16:00',
                        content: 'ã€å¿ƒå¾—åˆ†äº«ã€‘ã€Œæ„Ÿå®˜æ¢ç´¢ç›’ã€åˆé«”é©—\n\né¦™æ°›è Ÿç‡­çš„é¦™å‘³å¾ˆæ£’ï¼Œç‡Ÿé€ äº†å¾ˆå¥½çš„æ°›åœã€‚ç¾½æ¯›å’Œçœ¼ç½©çš„çµ„åˆè®“é«”é©—æ›´è±å¯Œï¼Œçµ²å·¾çš„è³ªæ„Ÿä¹Ÿå¾ˆå¥½ã€‚ç¬¬ä¸€æ¬¡å˜—è©¦æ„Ÿå®˜æ¢ç´¢ï¼Œæ„Ÿè¦ºå¾ˆæ–°é®®æœ‰è¶£ï¼'
                    }
                ]
            },
            learning: {
                icon: 'ğŸ‘¨â€âš•ï¸',
                name: 'å°ˆå®¶æ•™å­¸',
                messages: [
                    {
                        author: 'ç‹è«®å•†å¸«',
                        avatar: 'ğŸ‘¨â€âš•ï¸',
                        timestamp: '2024-01-15 08:00',
                        content: 'ã€å°ˆå®¶å°ˆæ¬„ã€‘å¦‚ä½•å»ºç«‹å¥åº·çš„è¦ªå¯†é—œä¿‚\n\nè¦ªå¯†é—œä¿‚çš„å»ºç«‹éœ€è¦æ™‚é–“ã€è€å¿ƒå’Œæºé€šã€‚æœ¬æ–‡å°‡æ¢è¨å¦‚ä½•åœ¨é—œä¿‚ä¸­å»ºç«‹ä¿¡ä»»ã€å°Šé‡å’Œç†è§£ï¼Œä»¥åŠå¦‚ä½•è™•ç†é—œä¿‚ä¸­çš„æŒ‘æˆ°ã€‚',
                        type: 'article'
                    },
                    {
                        author: 'æå°ˆå®¶',
                        avatar: 'ğŸ‘¨â€âš•ï¸',
                        timestamp: '2024-01-14 14:00',
                        content: 'ã€å°ˆå®¶å°ˆæ¬„ã€‘æ¢ç´¢èˆ‡æºé€šï¼šæƒ…ä¾¶é–“çš„é‡è¦èª²é¡Œ\n\nåœ¨è¦ªå¯†é—œä¿‚ä¸­ï¼Œæ¢ç´¢æ–°äº‹ç‰©å’Œæœ‰æ•ˆæºé€šæ˜¯ç¶­æŒé—œä¿‚å¥åº·çš„é‡è¦å› ç´ ã€‚æœ¬æ–‡åˆ†äº«å¦‚ä½•èˆ‡ä¼´ä¾¶è¨è«–æ•æ„Ÿè©±é¡Œï¼Œä»¥åŠå¦‚ä½•å»ºç«‹é–‹æ”¾çš„æºé€šç’°å¢ƒã€‚',
                        type: 'article'
                    },
                    {
                        author: 'å¼µè«®å•†å¸«',
                        avatar: 'ğŸ‘¨â€âš•ï¸',
                        timestamp: '2024-01-13 10:00',
                        content: 'ã€å°ˆå®¶å°ˆæ¬„ã€‘æ€§æ•™è‚²åŸºç¤çŸ¥è­˜\n\næ­£ç¢ºçš„æ€§æ•™è‚²çŸ¥è­˜å°æ–¼å»ºç«‹å¥åº·çš„è¦ªå¯†é—œä¿‚è‡³é—œé‡è¦ã€‚æœ¬æ–‡æ¶µè“‹æ€§å¥åº·ã€å®‰å…¨æ€§è¡Œç‚ºã€åŒæ„ç­‰é‡è¦ä¸»é¡Œã€‚',
                        type: 'article'
                    }
                ]
            }
        };
        
        function switchCommunityChannel(channelName) {
            currentCommunityChannel = channelName;
            
            // Update active channel
            document.querySelectorAll('.community-channel-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.community-channel-item').classList.add('active');
            
            // Update header
            document.getElementById('communityChannelHeaderIcon').textContent = communityChannelData[channelName].icon;
            document.getElementById('communityChannelHeaderName').textContent = communityChannelData[channelName].name;
            
            // Load messages
            loadCommunityMessages(channelName);
        }
        
        function loadCommunityMessages(channelName) {
            const container = document.getElementById('communityMessagesContainer');
            const messages = communityChannelData[channelName].messages;
            
            container.innerHTML = '';
            
            messages.forEach(msg => {
                if (msg.type === 'vote') {
                    container.appendChild(createCommunityVoteMessage(msg));
                } else if (msg.type === 'article') {
                    container.appendChild(createCommunityArticleMessage(msg));
                } else {
                    container.appendChild(createCommunityTextMessage(msg));
                }
            });
            
            container.scrollTop = container.scrollHeight;
        }
        
        function createCommunityTextMessage(msg) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'community-message';
            
            messageDiv.innerHTML = `
                <div class="community-message-header">
                    <div class="community-message-avatar">${msg.avatar}</div>
                    <div class="community-message-info">
                        <span class="community-message-author">${msg.author}</span>
                        <span class="community-message-timestamp">${msg.timestamp}</span>
                    </div>
                </div>
                <div class="community-message-content">${msg.content.replace(/\n/g, '<br>')}</div>
            `;
            
            return messageDiv;
        }
        
        function createCommunityVoteMessage(msg) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'community-message';
            
            let voteHTML = `
                <div class="community-message-header">
                    <div class="community-message-avatar">${msg.avatar}</div>
                    <div class="community-message-info">
                        <span class="community-message-author">${msg.author}</span>
                        <span class="community-message-timestamp">${msg.timestamp}</span>
                    </div>
                </div>
                <div class="community-message-content">
                    <div class="community-vote-poll">
                        <strong style="color: #FFFFFF;">${msg.content}</strong>
            `;
            
            msg.options.forEach(option => {
                const percentage = Math.round((option.votes / option.total) * 100);
                voteHTML += `
                    <div class="community-vote-option" onclick="communityVoteOption('${option.name}')">
                        <div>${option.name}</div>
                        <div class="community-vote-bar">
                            <div class="community-vote-fill" style="width: ${percentage}%">${percentage}%</div>
                        </div>
                    </div>
                `;
            });
            
            voteHTML += '</div></div>';
            messageDiv.innerHTML = voteHTML;
            
            return messageDiv;
        }
        
        function createCommunityArticleMessage(msg) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'community-message';
            
            messageDiv.innerHTML = `
                <div class="community-message-header">
                    <div class="community-message-avatar">${msg.avatar}</div>
                    <div class="community-message-info">
                        <span class="community-message-author">${msg.author}</span>
                        <span class="community-message-timestamp">${msg.timestamp}</span>
                    </div>
                </div>
                <div class="community-message-content">
                    <div class="community-article-card" onclick="showCommunityArticle('${msg.content}')">
                        <div class="community-article-title">${msg.content.split('\n')[0]}</div>
                        <div style="color: #DCDDDE; margin-top: 8px;">${msg.content.split('\n').slice(1).join('<br>')}</div>
                        <div class="community-article-meta">é»æ“Šé–±è®€å…¨æ–‡</div>
                    </div>
                </div>
            `;
            
            return messageDiv;
        }
        
        function sendCommunityMessage() {
            const input = document.getElementById('communityMessageInput');
            const content = input.value.trim();
            
            if (!content) return;
            
            const now = new Date();
            const timestamp = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
            
            const newMessage = {
                author: communityUsername,
                avatar: 'ğŸ‘¤',
                timestamp: timestamp,
                content: content
            };
            
            communityChannelData[currentCommunityChannel].messages.push(newMessage);
            loadCommunityMessages(currentCommunityChannel);
            
            input.value = '';
            input.style.height = 'auto';
        }
        
        function handleCommunityKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendCommunityMessage();
            }
        }
        
        function communityVoteOption(optionName) {
            alert(`æ‚¨å·²æŠ•ç¥¨çµ¦ï¼š${optionName}\n\nï¼ˆæ­¤ç‚º Demo ç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½éœ€é€£æ¥å¾Œç«¯ç³»çµ±ï¼‰`);
        }
        
        function showCommunityArticle(content) {
            alert('æ–‡ç« è©³æƒ…é é¢\n\nï¼ˆæ­¤ç‚º Demo ç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½éœ€é€£æ¥å¾Œç«¯ç³»çµ±ï¼‰');
        }
        
    </script>
</body>
</html>

